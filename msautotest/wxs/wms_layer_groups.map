#
# Test WMS layer groups
#
# REQUIRES: INPUT=GDAL OUTPUT=PNG SUPPORTS=WMS
#
# Capabilities 1.1.1 Default
# RUN_PARMS: wms_layer_groups_caps111.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.1.1&REQUEST=GetCapabilities" > [RESULT_DEVERSION] [RESULT_DEMIME]

# GetMap all
# RUN_PARMS: wms_layer_groups_map_all.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_g1.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,100,100&WIDTH=100&HEIGHT=100&LAYERS=g1&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_sg1.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,100,100&WIDTH=100&HEIGHT=100&LAYERS=sg1&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_sg2.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,100,100&WIDTH=100&HEIGHT=100&LAYERS=sg2&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_g2sg3l1.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,100,100&WIDTH=100&HEIGHT=100&LAYERS=g2sg3l1&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_g3.png [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=g3&STYLES=&FORMAT=image/png" > [RESULT_DEMIME]

# RUN_PARMS: wms_layer_groups_map_query_root.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png&QUERY_LAYERS=TESTGROUP&INFO_FORMAT=application/vnd.ogc.gml&I=0&J=0&RADIUS=500" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_query_g2.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png&QUERY_LAYERS=g2&INFO_FORMAT=application/vnd.ogc.gml&I=0&J=0&RADIUS=500" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_query_g2sg3l1.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png&QUERY_LAYERS=g2sg3l1&INFO_FORMAT=application/vnd.ogc.gml&I=0&J=0&RADIUS=500" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_query_g3.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png&QUERY_LAYERS=g3&INFO_FORMAT=application/vnd.ogc.gml&I=0&J=0&RADIUS=500" > [RESULT_DEMIME]
# RUN_PARMS: wms_layer_groups_map_query_g1_error.xml [MAPSERV] QUERY_STRING="map=[MAPFILE]&SERVICE=WMS&VERSION=1.3.0&REQUEST=GetFeatureInfo&CRS=EPSG:4326&BBOX=0,0,150,100&WIDTH=100&HEIGHT=150&LAYERS=TESTGROUP&STYLES=&FORMAT=image/png&QUERY_LAYERS=g1&INFO_FORMAT=application/vnd.ogc.gml&I=0&J=0&RADIUS=500" > [RESULT_DEMIME]


MAP


    NAME "TESTGROUP" 
    STATUS ON
    MAXSIZE 2048
    SIZE 100 100
    
    EXTENT 0 0 100 150
    UNITS dd
	WEB
	 METADATA
	 "ows_onlineresource" "http://foo"
	  "wms_enable_request" "*"
	 END
	END
	PROJECTION
	  "+init=epsg:4326"
	END

    IMAGECOLOR 255 255 255

	LAYER
	  TYPE POINT
	  NAME "g1sg1l1"
	  STATUS ON
	  METADATA
	    "wms_layer_group" "/g1/sg1"
	  END
	  CLASS
	    LABEL
		  TEXT "g1/sg1/l1"
		  COLOR 0 0 0
		  SIZE 8
		  POSITION cc
		END
	  END
	  FEATURE POINTS 50 10 END END
    END
	LAYER
	  TYPE POINT
	  NAME "g1sg1l2"
	  STATUS ON
	  METADATA
	    "wms_layer_group" "/g1/sg1"
	  END
	  CLASS
	    LABEL
		  TEXT "g1/sg1/l2"
		  COLOR 0 0 0
		  SIZE 8
		  POSITION cc
		END
	  END
	  FEATURE POINTS 50 30 END END
    END
	LAYER
	  TYPE POINT
	  NAME "g1sg2l1"
	  STATUS ON
	  METADATA
	    "wms_layer_group" "/g1/sg2"
	  END
	  CLASS
	    LABEL
		  TEXT "g1/sg2/l1"
		  COLOR 0 0 0
		  SIZE 8
		  POSITION cc
		END
	  END
	  FEATURE POINTS 50 50 END END
    END
	LAYER
          TEMPLATE "ttt"
	  TYPE POINT
	  NAME "g2sg3l1"
	  STATUS ON
	  METADATA
	    "wms_layer_group" "/g2/sg3"
	  END
	  CLASS
	    LABEL
		  TEXT "g2/sg3/l1"
		  COLOR 0 0 0
		  SIZE 8
		  POSITION cc
		END
	  END
	  FEATURE POINTS 50 70 END END
    END

    LAYER
        TEMPLATE "ttt"
        TYPE POINT
        NAME "g3l1"
        STATUS ON
        METADATA
            "wms_title" "g3l1 title"
            "wms_abstract" "g3l1 Abstract"

            "wms_layer_group" "/g3"
            "wms_group_title" "Group g3 title"
            "wms_group_abstract" "Group g3 Abstract"
        END
        CLASS
            LABEL
                TEXT "g3"
                COLOR 0 0 0
                SIZE 8
                POSITION cc
            END
        END
        FEATURE POINTS 50 90 END END
    END

    LAYER
        TEMPLATE "ttt"
        TYPE POINT
        NAME "g3sg4l1"
        STATUS ON
        METADATA
            "wms_layer_group" "/g3/sg4"
            "wms_title" "g3sg4l1 title"
            "wms_abstract" "g3sg4l1 Abstract"
            "wms_group_title" "Group g3/sg4 title"
            "wms_group_abstract" "Group g3/sg4 Abstract"
        END
        CLASS
            LABEL
                TEXT "g3/sg4/l1"
                COLOR 0 0 0
                SIZE 8
                POSITION cc
            END
        END
        FEATURE POINTS 50 110 END END
    END

END
